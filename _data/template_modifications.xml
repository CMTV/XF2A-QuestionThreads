<?xml version="1.0" encoding="utf-8"?>
<template_modifications>
  <modification type="public" template="core_button.less" modification_key="questionthreads_core_button" description="Adding solve/unsolve icons to action buttons" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[&--add          { .m-buttonIcon(@fa-var-plus-square, .79em); }]]></find>
    <replace><![CDATA[/* Questionthreads icons */

&--questionthreads-question		  { .m-buttonIcon(@fa-var-question, .5em); }
&--questionthreads-solve          { .m-buttonIcon(@fa-var-check, .79em); }
&--questionthreads-unsolve        { .m-buttonIcon(@fa-var-times, .79em); }

$0]]></replace>
  </modification>
  <modification type="admin" template="forum_edit" modification_key="questionthreads_forum_edit" description="Adding an option to mark forum as questions only" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<xf:option name="allow_posting"]]></find>
    <replace><![CDATA[<xf:option name="questionthreads_forum" selected="$forum.questionthreads_forum"
    label="{{ phrase('questionthreads_questions_forum_label') }}"
    hint="{{ phrase('questionthreads_questions_forum_hint') }}" />
$0]]></replace>
  </modification>
  <modification type="public" template="forum_post_thread" modification_key="questionthreads_forum_post_thread" description="Adding &quot;Is question&quot; option when creating a new thread" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<xf:macro template="helper_thread_options" name="thread_status" arg-thread="{$thread}" />
				</xf:if>]]></find>
    <replace><![CDATA[<xf:if is="!$forum.questionthreads_forum">
	<xf:checkboxrow label="{{ phrase('questionthreads_is_question') }}">
		<xf:option name="questionthreads_is_question" selected="false">{{ phrase('questionthreads_is_question_explain') }}</xf:option>
	</xf:checkboxrow>
</xf:if>

$0]]></replace>
  </modification>
  <modification type="public" template="forum_view" modification_key="questionthreads_forum_view_post_question_button" description="Replacing &quot;Post Thread&quot; text with &quot;Post question&quot;" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<xf:button href="{{ link('forums/post-thread', $forum) }}" class="button--cta" icon="write">
		{{ phrase('post_thread') }}
	</xf:button>]]></find>
    <replace><![CDATA[<xf:if is="$forum->questionthreads_forum">
	<xf:button href="{{ link('forums/post-thread', $forum) }}" class="button--cta" icon="questionthreads-question">
		{{ phrase('questionthreads_post_question') }}
	</xf:button>
<xf:else />
	$0
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="member_view" modification_key="questionthreads_member_view" description="Adding style to member view" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<h2 class="block-tabHeader block-tabHeader--memberTabs tabs hScroller"]]></find>
    <replace><![CDATA[<xf:css src="questionthreads.less"/>

$0]]></replace>
  </modification>
  <modification type="public" template="news_feed_item_post_insert" modification_key="questionthreads_news_feed_item_post_insert" description="Replacing &quot;thread&quot; with &quot;question&quot; for question threads in news feed" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[{{ phrase('news_feed_post_insert', {
		'username': username_link($user, false, {'defaultname': $newsFeed.username}),
		'threadTitle': '<a href="' . link('posts', $content) . '">' . prefix('thread', $content.Thread) . $content.Thread.title . '</a>'
	}) }}]]></find>
    <replace><![CDATA[<xf:if is="$content.Thread.questionthreads_is_question">
	{{ phrase('questionthreads_activity_reply_thread', {
		'username': username_link($user, false, {'defaultname': $newsFeed.username}),
		'threadTitle': '<a href="' . link('posts', $content) . '">' . prefix('thread', $content.Thread) . $content.Thread.title . '</a>'
	}) }}
<xf:else />
	$0
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="news_feed_item_thread_insert" modification_key="questionthreads_news_feed_item_thread_insert" description="Replacing &quot;thread&quot; with &quot;question&quot; for question threads in news feed" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[{{ phrase('news_feed_thread_insert', {
		'username': username_link($user, false, {'defaultname': $newsFeed.username}),
		'threadTitle': '<a href="' . link('threads', $content) . '">' . prefix('thread', $content) . $content.title . '</a>',
		'forumTitle': '<a href="' . link('forums', $content.Forum) . '">' . $content.Forum.title . '</a>'
	}) }}]]></find>
    <replace><![CDATA[<xf:if is="$content.questionthreads_is_question">
	{{ phrase('questionthreads_activity_new_thread', {
		'username': username_link($user, false, {'defaultname': $newsFeed.username}),
		'threadTitle': '<a href="' . link('threads', $content) . '">' . prefix('thread', $content) . $content.title . '</a>',
		'forumTitle': '<a href="' . link('forums', $content.Forum) . '">' . $content.Forum.title . '</a>'
	}) }}
<xf:else />
	$0
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="node_list.less" modification_key="questionthreads_node_list_less" description="Changing node icons for questions only forums" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[.node--forum &:before,
		.node--category &:before
		{
			.m-faContent(@fa-var-comments, 1em);
		}]]></find>
    <replace><![CDATA[$0

.node--forum.questionthreads_questions_forum &:before,
{
	.m-faContent(@fa-var-question-circle, 1em);
}]]></replace>
  </modification>
  <modification type="public" template="node_list_forum" modification_key="questionthreads_node_list_forum" description="Adding special class for questions only forums" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[	<div class="node node--id{$node.node_id} node--depth{$depth} node--forum {{ $extras.hasNew ? 'node--unread' : 'node--read' }}">]]></find>
    <replace><![CDATA[<xf:if is="$node->getData().questionthreads_forum">
		<div class="node node--id{$node.node_id} node--depth{$depth} questionthreads_questions_forum node--forum {{ $extras.hasNew ? 'node--unread' : 'node--read' }}">
<xf:else />
	$0
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="node_list_forum" modification_key="questionthreads_node_list_forum_label_meta" description="Replacing &quot;Threads&quot; with &quot;Questions&quot; label (meta)" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<dl class="pairs pairs--inline">
								<dt>{{ phrase('threads') }}</dt>]]></find>
    <replace><![CDATA[<xf:if is="$node->getData().questionthreads_forum">
	<dl class="pairs pairs--inline">
								<dt>{{ phrase('questionthreads_questions') }}</dt>
<xf:else/>
	$0
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="node_list_forum" modification_key="questionthreads_node_list_forum_label" description="Replacing &quot;Threads&quot; with &quot;Questions&quot; label" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<dl class="pairs pairs--rows">
						<dt>{{ phrase('threads') }}</dt>]]></find>
    <replace><![CDATA[<xf:if is="$node->getData().questionthreads_forum">
	<dl class="pairs pairs--rows">
								<dt>{{ phrase('questionthreads_questions') }}</dt>
<xf:else/>
	$0
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="post_edit" modification_key="questionthreads_post_edit_is_question" description="Adding &quot;Is question&quot; option when editing thread first post" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<xf:formrow rowtype="{{ $quickEdit ? 'fullWidth noLabel' : '' }}">
				<xf:if is="$attachmentData">
					<xf:macro template="helper_attach_upload" name="upload_block" arg-attachmentData="{$attachmentData}" />
				</xf:if>
				<xf:button class="button--link u-jsOnly" data-xf-click="preview-click" icon="preview" />
			</xf:formrow>]]></find>
    <replace><![CDATA[$0

<xf:if is="!$forum.questionthreads_forum && $post.isFirstPost()">
	<xf:formrow rowtype="{{ $quickEdit ? 'fullWidth noLabel' : '' }}">
		<xf:checkbox>
			<xf:option name="questionthreads_is_question" selected="{$thread.questionthreads_is_question}"
					   label="{{ phrase('questionthreads_is_question') }}"
					   hint="{{ phrase('questionthreads_is_question_explain') }}">
			</xf:option>
		</xf:checkbox>
	</xf:formrow>
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="post_macros" modification_key="questionthreads_post_macros" description="Adding &quot;Best answer&quot; and &quot;Not the best answer&quot; buttons" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<div class="actionBar-set actionBar-set--external">]]></find>
    <replace><![CDATA[$0

<xf:if is="$thread.questionthreads_is_question">
	<xf:if is="$thread.canRemoveBest() AND $post.post_id === $thread.questionthreads_best_post">
		<a href="{{ link('threads/removeBest', $thread) }}" class="actionBar-action questionthreads-unmark-best actionBar-action--unmark-best-answer"><i class="fa fa-times"></i>{{ phrase('questionthreads_button_unbest') }}</a>
	<xf:elseif is="$post.canMarkBest()" />
		<a href="{{ link('posts/markBest', $post) }}" class="actionBar-action questionthreads-mark-best actionBar-action--best-answer"><i class="{{ property('questionthreads_bestAnswerIcon') }}"></i>{{ phrase('questionthreads_button_best') }}</a>
	</xf:if>
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="post_macros" modification_key="questionthreads_post_macros_post_background" description="Changing best answer message background" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<div class="message-cell message-cell--main">]]></find>
    <replace><![CDATA[<xf:if is="$post.post_id === $thread.questionthreads_best_post">
	<div class="message-cell message-cell--main questionthreads-best-answer questionthreads-message">
<xf:else />
	$0
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="post_macros" modification_key="questionthreads_post_macros_user_background" description="Changing best answer user background" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<div class="message-cell message-cell--user">]]></find>
    <replace><![CDATA[<xf:if is="$post.post_id === $thread.questionthreads_best_post">
	<div class="message-cell message-cell--user questionthreads-best-answer questionthreads-user">
<xf:else />
	$0
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="search_result_post" modification_key="questionthreads_search_result_post" description="Adding solved-indicator and best answer link before thread title in search results page" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<h3 class="contentRow-title">]]></find>
    <replace><![CDATA[$0

<xf:if is="$post.Thread.questionthreads_is_question">
	<xf:if is="$post.Thread.questionthreads_is_solved">
		<div title="{{ phrase('questionthreads_solved_indicator_solved') }}" class="questionthreads-indicator questionthreads-solved"></div>
	<xf:else />
		<div title="{{ phrase('questionthreads_solved_indicator_unsolved') }}" class="questionthreads-indicator questionthreads-unsolved"></div>
	</xf:if>
	
	<xf:if is="$post.Thread.questionthreads_best_post">
		<a title="{{ phrase('questionthreads_link_to_best_answer') }}" class="questionthreads-best-answer-icon-link" href="{{ link('threads/post', $post.Thread, {'post_id': $post.Thread.questionthreads_best_post}) }}"></a>
	</xf:if>
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="search_result_thread" modification_key="questionthreads_search_result_thread" description="Adding solved-indicator and best answer link before thread title in search results page" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<h3 class="contentRow-title">]]></find>
    <replace><![CDATA[$0

<xf:if is="$thread.questionthreads_is_question">
	<xf:if is="$thread.questionthreads_is_solved">
		<div title="{{ phrase('questionthreads_solved_indicator_solved') }}" class="questionthreads-indicator questionthreads-solved"></div>
	<xf:else />
		<div title="{{ phrase('questionthreads_solved_indicator_unsolved') }}" class="questionthreads-indicator questionthreads-unsolved"></div>
	</xf:if>
	
	<xf:if is="$thread.questionthreads_best_post">
		<a title="{{ phrase('questionthreads_link_to_best_answer') }}" class="questionthreads-best-answer-icon-link" href="{{ link('threads/post', $thread, {'post_id': $thread.questionthreads_best_post}) }}"></a>
	</xf:if>
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="search_results" modification_key="questionthreads_search_results" description="Adding style to search results page" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<xf:css src="search_results.less" />]]></find>
    <replace><![CDATA[$0
<xf:css src="questionthreads.less" />]]></replace>
  </modification>
  <modification type="public" template="thread_edit" modification_key="questionthreads_thread_edit" description="Adding &quot;Is question&quot; option when editing existing thread" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<xf:macro template="helper_thread_options" name="thread_status" arg-thread="{$thread}" />]]></find>
    <replace><![CDATA[$0

<xf:if is="!$forum.questionthreads_forum">
	<xf:checkboxrow label="{{ phrase('questionthreads_is_question') }}">
		<xf:option name="questionthreads_is_question" selected="{$thread.questionthreads_is_question}">{{ phrase('questionthreads_is_question_explain') }}</xf:option>
	</xf:checkboxrow>
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="thread_list_macros" modification_key="questionthreads_thread_list_macros" description="Adding status indicator to question thread items" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<xf:if is="$thread.prefix_id">]]></find>
    <replace><![CDATA[<xf:if is="$thread.questionthreads_is_question">
	<xf:if is="$thread.questionthreads_is_solved">
		<div title="{{ phrase('questionthreads_solved_indicator_solved') }}" class="questionthreads-indicator questionthreads-solved"></div>
	<xf:else />
		<div title="{{ phrase('questionthreads_solved_indicator_unsolved') }}" class="questionthreads-indicator questionthreads-unsolved"></div>
	</xf:if>
	
	<xf:if is="$thread.questionthreads_best_post">
		<a title="{{ phrase('questionthreads_link_to_best_answer') }}" class="questionthreads-best-answer-icon-link" href="{{ link('threads/post', $thread, {'post_id': $thread.questionthreads_best_post}) }}"><i class="{{ property('questionthreads_bestAnswerIcon') }}"></i></a>
	</xf:if>
</xf:if>
$0]]></replace>
  </modification>
  <modification type="public" template="thread_list_macros" modification_key="questionthreads_thread_list_macros_style" description="Adding style to question thread items" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<xf:css src="structured_list.less" />]]></find>
    <replace><![CDATA[$0
<xf:css src="questionthreads.less" />]]></replace>
  </modification>
  <modification type="public" template="thread_list_macros" modification_key="questionthreads_thread_list_macros_placeholder" description="Changing placeholder for fast question creation form" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<xf:prefixinput maxlength="{{ max_length('XF:Thread', 'title') }}"
						placeholder="{$forum.thread_prompt}"
						title="{{ phrase('post_new_thread_in_this_forum') }}"
						prefix-value="{$forum.default_prefix_id}"
						type="thread"
						prefixes="{{ $forum.getUsablePrefixes() }}"
						data-xf-init="tooltip"
						rows="1"/>]]></find>
    <replace><![CDATA[<xf:if is="$forum.questionthreads_forum">
	<xf:prefixinput maxlength="{{ max_length('XF:Thread', 'title') }}"
					placeholder="{{ phrase('questionthreads_thread_prompt') }}"
					title="{{ phrase('post_new_thread_in_this_forum') }}"
					prefix-value="{$forum.default_prefix_id}"
					type="thread"
					prefixes="{{ $forum.getUsablePrefixes() }}"
					data-xf-init="tooltip"
					rows="1"/>
	<xf:else />
	$0
</xf:if>]]></replace>
  </modification>
  <modification type="public" template="thread_view" modification_key="questionthreads_thread_view_solved_indicator" description="Adding solved-indicator before question title in &quot;thread_view&quot; template" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<xf:h1>]]></find>
    <replace><![CDATA[<xf:css src="questionthreads.less"/>
$0
<xf:if is="$thread.questionthreads_is_question">
	<xf:if is="$thread.questionthreads_is_solved">
		<div title="{{ phrase('questionthreads_solved_indicator_solved') }}" class="questionthreads-indicator questionthreads-solved questionthreads-big"></div>
	<xf:else />
		<div title="{{ phrase('questionthreads_solved_indicator_unsolved') }}" class="questionthreads-indicator questionthreads-unsolved questionthreads-big"></div>
	</xf:if>
</xf:if>
]]></replace>
  </modification>
  <modification type="public" template="thread_view" modification_key="questionthreads_thread_view_solve_unsolve_action" description="Adding solve/unsolve button at top right corner of thread view container" execution_order="10" enabled="1" action="str_replace">
    <find><![CDATA[<xf:title page="{$page}">{{ prefix('thread', $thread, 'escaped') }}{$thread.title}</xf:title>]]></find>
    <replace><![CDATA[$0

<xf:pageaction if="$thread.canSolve()">
	<xf:button href="{{ link('threads/solve', $thread) }}" class="button questionthreads-solve-action-button" icon="questionthreads-solve">
		{{ phrase('questionthreads_button_solve') }}
	</xf:button>
</xf:pageaction>

<xf:pageaction if="$thread.canUnsolve()">
	<xf:button href="{{ link('threads/unsolve', $thread) }}" class="button questionthreads-unsolve-action-button" icon="questionthreads-unsolve">
		{{ phrase('questionthreads_button_unsolve') }}
	</xf:button>
</xf:pageaction>]]></replace>
  </modification>
</template_modifications>
